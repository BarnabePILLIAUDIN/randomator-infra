
name: randomator-production
docker:
  auth_secret_name: docker-auth

deployments:
  front:
    replicas: 2
    image: barnabepilliaudin/randomator:front-latest
    container_port: 80
    env:
      VITE_API_URL: http://prod-back.barnabepilliaudin.fr
  back:
    replicas: 2
    image: barnabepilliaudin/randomator:back-latest
    container_port: 3000
    env:
      CORS: http://prod-front.barnabepilliaudin.fr

services:
  front:
    external_port: 80
    type: ClusterIP
  back:
    external_port: 3000
    type: ClusterIP

ingresses:
  front:
    domain: prod-front.barnabepilliaudin.fr
    tls: true
    tls_secret: front-tls-secret
  back:
    domain: prod-back.barnabepilliaudin.fr
    tls: true
    tls_secret: back-tls-secret
